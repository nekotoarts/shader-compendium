<!DOCTYPE html>
<html lang="en">
	<head>
		
<!--KaTeX-->
<link
	rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
	integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X"
	crossorigin="anonymous"
/>
<script
	defer
	src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"
	integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4"
	crossorigin="anonymous"
></script>
<script
	defer
	src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"
	integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa"
	crossorigin="anonymous"
></script>
<script>
	document.addEventListener("DOMContentLoaded", function () {
		renderMathInElement(document.body, {
			// customised options
			// • auto-render specific keys, e.g.:
			delimiters: [
				{ left: "$$", right: "$$", display: true },
				{ left: "$", right: "$", display: false },
				{ left: "\\(", right: "\\)", display: false },
				{ left: "\\[", right: "\\]", display: true },
			],
			// • rendering keys, e.g.:
			throwOnError: false,
		});
	});
</script>

<!-- GLSL Canvas -->
<script
	type="text/javascript"
	src="https://unpkg.com/glsl-canvas-js/dist/umd/glsl-canvas.min.js"
></script>

<!-- Jekyll Chapterbook guy took out syntax highlighting idky -->
<link rel="stylesheet" href="/shader-compendium/assets/gitbook/rouge/nekoto_theme.css">

<meta charset="UTF-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"><title>Navier-Stokes Equations and FDM · Shader Compendium</title><meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="description" content="A collection of chapters to help you better understand the world of shaders">

<meta name="generator" content="Jekyll (using jekyll-chapterbook theme)"><meta name="author" content="NekotoArts"><link rel="stylesheet" href="/shader-compendium/assets/gitbook/style.css">
<link rel="stylesheet" href="/shader-compendium/assets/gitbook/gitbook-plugin-fontsettings/website.css"><!--
  <link rel="stylesheet" href="/shader-compendium/assets/gitbook/gitbook-plugin-search-pro/search.css">
  <link rel="stylesheet" href="/shader-compendium/assets/gitbook/gitbook-plugin-back-to-top-button/plugin.css">
  <link rel="stylesheet" href="/shader-compendium/assets/gitbook/rouge/nekoto_theme.css">
  --><link rel="stylesheet" href="/shader-compendium/assets/gitbook/custom.css">
<link rel="stylesheet" href="/shader-compendium/assets/chapterbook/chapterbook.css">

<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<!--
<link
  rel="apple-touch-icon-precomposed"
  sizes="152x152"
  href="/shader-compendium/assets/gitbook/images/apple-touch-icon-precomposed-152.png">
-->
  
<link
  rel="shortcut icon"
  href="/shader-compendium/assets/gitbook/images/favicon.ico"
  type="image/x-icon">


<link rel="stylesheet" href="/shader-compendium/assets/extra.css">



<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>
		<link rel="canonical" href="https://nekotoarts.github.io/shader-compendium/navier-stokes-finite-difference.html" />
		  
		<link rel="prev" href="/shader-compendium/rasterization.html" />
		 
		<link rel="next" href="/shader-compendium/fluids-high-level-solution.html" />
		 
	</head>
	<body>
		<div class="book">
			
  <div class="book-summary">
    <nav role="navigation">
      <ul class="summary chapter-summary">

        
          
            
            
            
            <li class="chapter ">
              <a href="/shader-compendium/index.html" class="">The Shader Compendium</a>
            </li>
          
          <li class="divider"></li>
        

        



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





        

          
          
            
          

          

          

          

          
            <li class="chapter ">
          

            <a href="/shader-compendium/book.html">
              
              Book Information
            </a>

            
              
            
          </li>

          



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





        

          
          
            
          

          

          

          

          
            <li class="chapter ">
          

            <a href="/shader-compendium/contents.html">
              
              Table of Contents
            </a>

            
              
            
          </li>

          



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





        

          
          
            
          

          

          
            <li class="header ">
              
              Part 1: The basics
              
            </li>
          

          

          
            <li class="chapter ">
          

            <a href="/shader-compendium/what-are-shaders.html">
              
                1.
              
              What are Shaders?
            </a>

            
              
            
          </li>

          



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





        

          
          
            
          

          

          

          

          
            <li class="chapter ">
          

            <a href="/shader-compendium/gpu-design.html">
              
                2.
              
              The GPU Design
            </a>

            
              
            
          </li>

          



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





        

          
          
            
          

          

          
            <li class="header ">
              
              Part 2: Realtime rendering
              
            </li>
          

          

          
            <li class="chapter ">
          

            <a href="/shader-compendium/rendering-equation.html">
              
                3.
              
              The Rendering Equation
            </a>

            
              
            
          </li>

          



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





        

          
          
            
          

          

          

          

          
            <li class="chapter ">
          

            <a href="/shader-compendium/solving-rendering-equation.html">
              
                4.
              
              Solving the Rendering Equation
            </a>

            
              
            
          </li>

          



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





        

          
          
            
          

          

          

          

          
            <li class="chapter ">
          

            <a href="/shader-compendium/rasterization.html">
              
                5.
              
              Rasterization
            </a>

            
              
            
          </li>

          



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





        

          
          
            
          

          
            



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





            

          
          
            
          

          
            



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





            

          
          
            
          

          
            



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





            

          
          
            
          

          
            



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





            

          
          
            
          

          
            



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





            

          
          
            
          

          
            



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





            

          
          
            
          

          
            



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





            

          
          
            
          

          
            



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





            

          
          
            
          

          
            



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





            

          
          
            
          

          
            



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





            

          
          
            
          

          
            



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





            

          
          
            
          

          
            



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





            

          
          
            
          

          
            



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





            

          
          
            
          

          
            



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





            

          
          
            














          

          

          
            <li class="header ">
              
              Part 6: Gpu fluids
              
            </li>
          

          

          
            <li class="chapter active">
          

            <a href="/shader-compendium/navier-stokes-finite-difference.html">
              
                6.
              
              Navier-Stokes Equations and FDM
            </a>

            
              
                <ul><li><a href="#navier-stokes-equations">Navier-Stokes Equations</a><ul><li><a href="#advection">Advection</a></li><li><a href="#pressure">Pressure</a></li><li><a href="#diffusion">Diffusion</a></li></ul></li><li><a href="#vector-calculus-operators">Vector Calculus Operators</a><ul><li><a href="#finite-difference-approximations">Finite Difference Approximations</a></li></ul></li></ul>

              
            
          </li>

          



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





        

          
          
            
              














            
          

          

          

          

          
            <li class="chapter ">
          

            <a href="/shader-compendium/fluids-high-level-solution.html">
              
                7.
              
              High-Level Solution Overview
            </a>

            
              
            
          </li>

          



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





        

          
          
            
          

          

          

          

          
            <li class="chapter ">
          

            <a href="/shader-compendium/helmholtz-hodge-decomposition.html">
              
                8.
              
              Helmholtz-Hodge Decomposition
            </a>

            
              
            
          </li>

          



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





        

          
          
            
          

          

          

          

          
            <li class="chapter ">
          

            <a href="/shader-compendium/stam-advection.html">
              
                9.
              
              Jos Stam Advection Scheme
            </a>

            
              
            
          </li>

          



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





        

          
          
            
          

          

          

          

          
            <li class="chapter ">
          

            <a href="/shader-compendium/references.html">
              
              References
            </a>

            
              
            
          </li>

          



















  
  


















        

          
          
            
          

          
            



















  
  
  
  
  
  
  

  
  
  
  

  
  
  
  

  

  





            

        
          <li class="divider"></li>
          
            
            
            
            <li class="chapter ">
              <a href="/shader-compendium/outline.html" class="">Book Outline</a>
            </li>
          
            
            
            
            <li class="chapter ">
              <a href="https://github.com/nekotoarts/shader-compendium/" class="">Star on GitHub</a>
            </li>
          
        

      </ul>
    </nav>
  </div>
  

			<div class="book-body">
				<div class="book-header" role="navigation">
					
					<a
						href="https://github.com/nekotoarts/shader-compendium/edit/main/_chapters/060-GPU-fluids/010-navier-stokes-equations-and-finite-difference-models.md"
						target="_blank"
						title="Edit on GitHub"
						class="github-edit-link"
					>
						<i class="fa fa-github"></i>
					</a>
					
					<h1>
						<a href="/shader-compendium/index.html"
							>Shader Compendium</a
						>
					</h1>
				</div>
				<!-- .book-header -->

				<div class="body-inner">
					<!-- introduce per-page mermaid support -->
					<!--  -->
					<div class="page-wrapper" tabindex="-1" role="main">
						<div
							class="page-inner "
						>
							 




  <nav aria-label="Breadcrumb" class="breadcrumb markdown-section">
    <ul>
      
        
          <li>
              
              <a href="/shader-compendium/book.html">
            
              <img class="book-icon" src="/shader-compendium/assets/gitbook/images/apple-touch-icon-precomposed-152.png">
              Book
            
              </a>
            
          </li>
      

      
        
        <li >
          
            <a href="/shader-compendium/contents.html">
          
            Contents
          
            </a>
          
        </li>
      

      

      
        

          
            
              <li class="breadcrumb-part">
                
                Part 6: Gpu fluids
                
              </li>
            
          

          
            <li class="no-arrow">
              Chapter 6.
            </li>
          

        
      
    </ul>
  </nav>

  
    <h1
      id="navier-stokes-finite-difference"
      data-level="1.1"
      class="heading-chapter-title no_toc">Navier-Stokes Equations and FDM</h1>
  


<section class="normal markdown-section">

  

  
    
    

    
      <div class="page-toc">
        <div class="page-toc-heading">
          In this chapter:
          <ul><li><a href="#navier-stokes-equations">Navier-Stokes Equations</a><ul><li><a href="#advection">Advection</a></li><li><a href="#pressure">Pressure</a></li><li><a href="#diffusion">Diffusion</a></li></ul></li><li><a href="#vector-calculus-operators">Vector Calculus Operators</a><ul><li><a href="#finite-difference-approximations">Finite Difference Approximations</a></li></ul></li></ul>
        </div>
      </div>
    
  

  <div>
<canvas class="glsl-canvas glsl-small" data-fragment-url="/shader-compendium/assets/shaders/fluidsinglepass.frag" />
</div>

<h2 id="navier-stokes-equations">Navier-Stokes Equations</h2>

<p>The Navier-Stokes Equations are a series of partial differential equations that are used to describe the motion of viscous fluids.</p>

<p>In order to simulate fluid-like motion we need to calculate a solution to the Navier-Stokes equations in real time, which proves to be quite a challenge.</p>

<p><strong>For this chapter, we are only going to focus on developing a <em>2D Eulerian</em> solution for incompressible Newtonian fluids (like water) with constant density and constant viscosity</strong>. Detailing exactly how the Navier-Stokes equations were developed is beyond the scope of this book, we are only going to discuss methods to solve these equations in real-time using the GPU.</p>

<blockquote>
  <p>“Eulerian” simulations means that the solution domain is a grid of cells and the solution for the equations are calculated for every cell in the grid. This “grid” is very similar to a texture with pixels, which makes it ideal for us to implement an Eulerian solution on the GPU because then our solution domain is simply the values of the texture.</p>
</blockquote>

<p>The two governing equations for our model are as follows:</p>

<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi mathvariant="normal">∇</mi><mo>⋅</mo><mover accent="true"><mi>u</mi><mo>⃗</mo></mover><mo>=</mo><mn>0</mn><mtext>  </mtext><mtext>(Incompressible Flow)</mtext></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\tag{1}
\nabla \cdot \vec{u} = 0 \; \textrm{(Incompressible Flow)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">∇</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">u</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord textrm">(Incompressible Flow)</span></span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span></span><span class="mord">)</span></span></span></span></span></span>

<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>u</mi><mo>⃗</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><munder><munder><mrow><mo>−</mo><mo stretchy="false">(</mo><mover accent="true"><mi>u</mi><mo>⃗</mo></mover><mo>⋅</mo><mi mathvariant="normal">∇</mi><mo stretchy="false">)</mo><mover accent="true"><mi>u</mi><mo>⃗</mo></mover></mrow><mo stretchy="true">⏟</mo></munder><mtext>Advection</mtext></munder><mo>−</mo><munder><munder><mrow><mfrac><mn>1</mn><mi>ρ</mi></mfrac><mi mathvariant="normal">∇</mi><mi>p</mi></mrow><mo stretchy="true">⏟</mo></munder><mtext>Pressure</mtext></munder><mo>+</mo><munder><munder><mrow><mi>ν</mi><msup><mi mathvariant="normal">∇</mi><mn>2</mn></msup><mover accent="true"><mi>u</mi><mo>⃗</mo></mover></mrow><mo stretchy="true">⏟</mo></munder><mtext>Diffusion</mtext></munder><mo>+</mo><munder><munder><mover accent="true"><mi>F</mi><mo>⃗</mo></mover><mo stretchy="true">⏟</mo></munder><mtext>External Forces</mtext></munder></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\tag{2}
\frac{\partial \vec{u}}{\partial t} = \underbrace{-(\vec{u}\cdot\nabla)\vec{u}}_{\text{Advection}} - \underbrace{\frac{1}{\rho}\nabla p}_{\text{Pressure}} + \underbrace{\nu \nabla^2 \vec{u}}_{\text{Diffusion}} + \underbrace{\vec{F}}_{\text{External Forces}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.077em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.391em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">u</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3341em;vertical-align:-1.5841em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-1.4159em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Advection</span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span class="svg-align" style="top:-2.102em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">u</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">∇</span><span class="mclose">)</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">u</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.898em;"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5841em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.5282em;vertical-align:-2.2068em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-1.1147em;"><span class="pstrut" style="height:3.3214em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Pressure</span></span></span></span></span><span style="top:-3.3214em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span class="svg-align" style="top:-1.793em;"><span class="pstrut" style="height:3.3214em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style="top:-3.3214em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">ρ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∇</span><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5284em;"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.2068em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.1982em;vertical-align:-1.3341em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-1.6659em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Diffusion</span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span class="svg-align" style="top:-2.352em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.06366em;">ν</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">u</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.648em;"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3341em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.3004em;vertical-align:-1.3341em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9663em;"><span style="top:-1.6659em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">External Forces</span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9663em;"><span class="svg-align" style="top:-2.352em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9663em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.648em;"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3341em;"><span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:3.5978em;vertical-align:-2.2068em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span>

<p>where:</p>

<ul>
  <li>$\vec{u}$ is the fluid velocity field</li>
  <li>$\rho$ is the fluid density</li>
  <li>$p$ is the fluid pressure</li>
  <li>$\nu$ is the fluid viscosity</li>
  <li>$\vec{F}$ is the vector field of external forces applied to the fluid</li>
</ul>

<h3 id="advection">Advection</h3>

<p>Advection is the movement of some quantity in the direction of the velocity vectors of the velocity vector field. For fluids, properties such as the the fluid temperature, substances in the fluid, and even the velocities themselves!</p>

<h3 id="pressure">Pressure</h3>

<p>According to <a class="citation" href="/shader-compendium/references.html#fernando_gpu_2004">Fernando (2004)</a>, external forces applied to a fluid do not instantly propagate through the entire fluid, first pressure builds up near the applied area and then that pushes on particles further away. Any pressure in the fluid naturally leads to acceleration.</p>

<h3 id="diffusion">Diffusion</h3>

<p>Diffusion is the movement of some quantity in the fluid from a region of higher concentration to a region of lower concentration.</p>

<p>Diffusion is primarily controlled by viscosity. Viscosity is a measure of the fluid’s resistance to flow. Fluids with higher viscosity such as honey or maple syrup take more effort to get moving.</p>

<figure class="figure color-callout-light with-border row">
  <a href="/shader-compendium/assets/images/chapter6/pexels-roman-odintsov-6422025.jpg" target="_blank" title="Honey is a viscous fluid so it requires more effort to move (Click to open figure in a new window.)">
    <img src="/shader-compendium/assets/images/chapter6/pexels-roman-odintsov-6422025.jpg" alt="Honey is a viscous fluid so it requires more effort to move" border="0" />
  </a>
  <figcaption class="color-callout-dark">Honey is a viscous fluid so it requires more effort to move</figcaption>
</figure>

<h2 id="vector-calculus-operators">Vector Calculus Operators</h2>

<p>In the Navier-Stokes equations above we see a lot of these upside down triangle symbols $\nabla$. That symbol is a Greek letter called lambda, and it is used to represent quite a few different vector calculus operations.</p>

<p>Here’s a table that describes their notation and what they mean:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Vector Calculus Operator</th>
      <th style="text-align: center">Notation</th>
      <th>Definition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Gradient Operator</td>
      <td style="text-align: center">$\nabla x$</td>
      <td>Shows the direction and rate of fastest increase of a scalar field</td>
    </tr>
    <tr>
      <td style="text-align: center">Divergence Operator</td>
      <td style="text-align: center">$\nabla \cdot \vec{x}$</td>
      <td>Shows how much a point acts like a source or sink</td>
    </tr>
    <tr>
      <td style="text-align: center">Curl Operator</td>
      <td style="text-align: center">$\nabla \times \vec{x}$</td>
      <td>Shows how much a field swirls or rotates around a point</td>
    </tr>
    <tr>
      <td style="text-align: center">Laplacian Operator</td>
      <td style="text-align: center">$\nabla^2 \; \vec{x}$ OR $\nabla^2 \; x$</td>
      <td>Shows how a value differs from the average around it</td>
    </tr>
  </tbody>
</table>

<h3 id="finite-difference-approximations">Finite Difference Approximations</h3>

<p>The definitions of these operators are used over <strong>continuous</strong> vector fields, however, our simulation data only exists at <strong>discrete</strong> intervals (which is wherever our pixels are located).</p>

<p>This means that we can’t directly use the definition of these operators in our equation but instead need to develop a discretized representation of them instead. This is done using <strong>finite difference models</strong>.</p>

<p>This table illustrates each operator and its equivalent finite difference approximation, which we will use when developing our shaders. Specifically, the approximations shown here are <em>second-order centered finite difference approximations</em>.</p>

<p>For simplicity, let $\vec{u}$ be a 2D vector field with components $u$ and $v$ such that $\vec{u} = (u,v)$, and let $p$ be a 2D scalar field. Then, each of these operators can be approximated as shown below:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Operator</th>
      <th style="text-align: center">Continuous Definition</th>
      <th style="text-align: center">Finite Difference Approximation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">$\nabla p$</td>
      <td style="text-align: center">$\Large\left[ \frac{\partial p}{\partial x}, \frac{\partial p}{\partial y} \right]$</td>
      <td style="text-align: center">$\Large\left[ \frac{p_{i+1,j} - p_{i-1,j}}{2\delta x}, \frac{p_{i,j+1} - p_{i,j-1}}{2\delta y} \right]$</td>
    </tr>
    <tr>
      <td style="text-align: center">$\nabla \cdot \vec{u}$</td>
      <td style="text-align: center">$\Large\frac{\partial u}{\partial x} + \frac{\partial v}{\partial y}$</td>
      <td style="text-align: center">$\Large\frac{u_{i+1,j} - u_{i-1,j}}{2\delta x} + \frac{v_{i,j+1} - v_{i,j-1}}{2\delta y}$</td>
    </tr>
    <tr>
      <td style="text-align: center">$\nabla \times \vec{u}$</td>
      <td style="text-align: center">$\Large\frac{\partial v}{\partial x} - \frac{\partial u}{\partial y}$</td>
      <td style="text-align: center">$\Large \begin{bmatrix} 0,0, \frac{v_{i+1,j} - v_{i-1,j}}{2\delta x} - \frac{u_{i,j+1} - u_{i,j-1}}{2\delta y} \end{bmatrix}$</td>
    </tr>
    <tr>
      <td style="text-align: center">$\nabla^2 p$</td>
      <td style="text-align: center">$\Large\frac{\partial^2 p}{\partial x^2} + \frac{\partial^2 p}{\partial y^2}$</td>
      <td style="text-align: center">$\Large\frac{p_{i+1,j} - 2p_{i,j} + p_{i-1,j}}{(\delta x)^2} + \frac{p_{i,j+1} - 2p_{i,j} + p_{i,j-1}}{(\delta y)^2}$</td>
    </tr>
    <tr>
      <td style="text-align: center">$\nabla^2 \vec{u}$</td>
      <td style="text-align: center">$\Large\frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 v}{\partial y^2}$</td>
      <td style="text-align: center">$\Large\begin{bmatrix}\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\delta x)^2} + \frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\delta y)^2} \atop \frac{v_{i+1,j} - 2v_{i,j} + v_{i-1,j}}{(\delta x)^2} + \frac{v_{i,j+1} - 2v_{i,j} + v_{i,j-1}}{(\delta y)^2}\end{bmatrix}$</td>
    </tr>
  </tbody>
</table>


  
</section>


  <div class="chapter-pager">

    
      
      <a
        href="/shader-compendium/fluids-high-level-solution.html"
        class="chapter-next "
        aria-label="Next page: High-Level Solution Overview"
        data-level="1.1"
        data-path="/shader-compendium/fluids-high-level-solution.html">
        <div class="pager-arrow">
          <i class="fa fa-arrow-right"></i>
        </div>
        <div class="pager-labels">
          <div class="part">
            Next:
            
              
                Gpu fluids
                 &#8250;
              
              Chapter 7.
            
          </div>
          <div class="chapter-label">
            High-Level Solution Overview
          </div>
        </div>
      </a>
    

    
      
      <a
        href="/shader-compendium/rasterization.html"
        class="chapter-prev "
        aria-label="Previous page: Rasterization"
        data-level="1.1"
        data-path="/shader-compendium/rasterization.html">
        <div class="pager-arrow">
          <i class="fa fa-arrow-left"></i>
        </div>
        <div class="pager-labels">
          <div class="part">
            Previous:
            
              
                Realtime rendering
                &#8250;
              
              Chapter 5.
            
          </div>
          <div class="chapter-label">
            Rasterization
          </div>
        </div>
      </a>
    

    <div style="clear: both;"></div>
  </div>
  <!-- .chapter-pager -->

 
						</div>
						<!-- .page-inner -->
					</div>
					<!-- .page-wrapper -->
				</div>
				<!-- .body-inner -->
				<div class="page-footer">
					 
					<div class="bottom-nav">
						    
						<a href="/shader-compendium/index.html"> Home </a>
						  -    
						<a href="/shader-compendium/book.html"> Book </a>
						  -    
						<a href="https://github.com/nekotogd"> GitHub </a>
						  -    
						<a href="/shader-compendium/privacy.html"> Privacy </a>
						
					</div>
					 
					<div class="copyright">
						  
						<a href="/shader-compendium/book.html">
							 &copy;   2024- 2025 NekotoArts 
						</a>
						
					</div>
					
				</div>
				<!-- .chapter-footer -->
			</div>
			<!-- .book-body -->
		</div>
		<!-- .book --><!--
<script src="/shader-compendium/assets/chapterbook/require.js"></script>
<script src="/shader-compendium/assets/chapterbook/jquery-3.6.0.min.js"></script>
-->

<script src="/shader-compendium/assets/gitbook/gitbook.js"></script>
<script src="/shader-compendium/assets/gitbook/theme.js"></script>

<script src="/shader-compendium/assets/chapterbook/chapterbook.js"></script>

<script src="/shader-compendium/assets/gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>

<!--
<script src="/shader-compendium/assets/gitbook/gitbook-plugin-sharing/buttons.js"></script>
-->

<!-- <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
<script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
<script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
<script src="../gitbook/gitbook-plugin-search/search.js"></script> -->

<!-- // JG
<script src="/shader-compendium/assets/gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
<script src="/shader-compendium/assets/gitbook/gitbook-plugin-search-pro/search.js"></script>
-->
<script src="/shader-compendium/assets/gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>

<!--
<script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
-->


<script>
			// var gitbook = gitbook || [];
			gitbook.push(function() {
			  gitbook.page.hasChanged({
  "page": {
    "title": "Introduction",
    "level": "1.1",
    "depth": 1,
    "dir": "ltr"
  },

  "config": {
   "plugins": ["fontsettings"],
    "styles": {
      "ebook": "styles/ebook.css",
      "epub": "styles/epub.css",
      "mobi": "styles/mobi.css",
      "pdf": "styles/pdf.css",
      "print": "styles/print.css",
      "website": "styles/website.css"
    },
    "pluginsConfig": {
      "fontsettings": {
        "family": "sans",
        "size": 2,
        "theme": "white"
      },
      "theme-default": {
        "showLevel": false,
        "styles": {
          "ebook": "styles/ebook.css",
          "epub": "styles/epub.css",
          "mobi": "styles/mobi.css",
          "pdf": "styles/pdf.css",
          "print": "styles/print.css",
          "website": "styles/website.css"
        }
      }
    },
    "theme": "default",
    "author": "",
    "pdf": {
      "pageNumbers": true,
      "fontSize": 12,
      "fontFamily": "Arial",
      "paperSize": "a4",
      "chapterMark": "pagebreak",
      "pageBreaksBefore": "/",
      "margin": {
        "right": 62,
        "left": 62,
        "top": 56,
        "bottom": 56
      }
    },
    "structure": {
      "langs": "LANGS.md",
      "readme": "README.md",
    },
    "variables": {},
    "title": "Shader Compendium",
    "language": "en",
    "gitbook": "*"
  },
  "file": {
    "path": "_chapters/060-GPU-fluids/010-navier-stokes-equations-and-finite-difference-models.md",
    "mtime": "2025-10-15 23:22:09 +0400",
    "type": "markdown"
  },
  "gitbook": {
    "version": "",
    "time": "2025-10-15 23:22:09 +0400"
  },
  "basePath": "/shader-compendium",
  "book": {
    "language": ""
  }
}
);
			});
		</script>

		<script src="/shader-compendium/assets/js-custom/glsl-extra-keywords.js"></script>
	</body>
</html>
